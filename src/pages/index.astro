---
// File: src/pages/index.astro
import Layout from "../layouts/LMIlayout.astro";
import AboutSection from "../components/sections/AboutSection.astro";
import GallerySection from "../components/sections/GallerySection.astro";
import ServiceSection from "@/components/sections/ServiceSection.astro";
import MaterialSection from "@/components/sections/MaterialSection.astro";
import WorkSection from "@/components/sections/WorkSection.astro";
import FeaturesSection from "@/components/sections/FeaturesSection.astro";
import BookSection from "@/components/sections/BookSection.astro";
import TestimonialsSection from "@/components/sections/TestimonialsSection.astro";
import CTASection from "@/components/sections/CTASection.astro";
import ClientSection from "@/components/sections/ClientSection.astro";
import SizeSection from "@/components/sections/SizeSection.astro";
import FAQSection from "@/components/sections/FAQSection.astro";
import HeroSection from "@/components/sections/HeroSection.astro";
import IconBoxSection from "@/components/sections/IconBoxSection.astro";

// Impor semua komponen bagian yang akan Anda gunakan di halaman ini
//import HeroSlider from '../components/HeroSlider.astro';
//import AboutSection from '../components/AboutSection.astro';
//import ServiceSection from '../components/ServiceSection.astro';
//import BookingFormSection from '../components/BookingFormSection.astro';
// ...impor komponen lainnya jika Anda membuatnya
---

<Layout title="Mitra Pengadaan Seragam No 1 di Indonesia | Lamonte Costum">
	<div class="site-preloader-wrap">
		<div class="spinner"></div>
	</div>

	<HeroSection />

	<IconBoxSection />
	<!-- why us -->
	<AboutSection />
	
	<!-- Testimonials -->
	<TestimonialsSection />

	<!-- pelayanan -->
	<ServiceSection />
	<!-- Material -->
	<MaterialSection />

	<!-- Features -->
	<FeaturesSection />

	<!-- Gallery -->
	<GallerySection />

	<!-- Process -->
	<WorkSection />

	<!-- client Section -->
	<ClientSection />

	<!-- Size Section -->
	<SizeSection />

	<!-- Size Section -->
	<FAQSection />

	<!-- Book Section -->
	<BookSection />

	<!-- Cta section -->
	<CTASection />

	<script>
		const form = document.getElementById(
			"consultation-form"
		) as HTMLFormElement;
		const nameInput = document.getElementById("name") as HTMLInputElement;
		const waInput = document.getElementById("wa") as HTMLInputElement;
		const formMessages = document.getElementById(
			"form-messages"
		) as HTMLElement;
		const submitButton = document.getElementById("submit") as HTMLButtonElement;

		if (form && nameInput && waInput && formMessages && submitButton) {
			form.addEventListener("submit", async function (event) {
				event.preventDefault();
				formMessages.textContent = "";
				formMessages.className = "alert";

				const nameValue = nameInput.value.trim();
				const waValue = waInput.value.trim();

				if (nameValue.length < 5) {
					formMessages.textContent = "Nama harus minimal 5 karakter.";
					formMessages.className = "alert alert-danger";
					return;
				}
				if (!/^[A-Za-z\s]+$/.test(nameValue)) {
					formMessages.textContent = "Nama hanya boleh huruf dan spasi.";
					formMessages.className = "alert alert-danger";
					return;
				}
				if (!/^(08\d{8,11}|628\d{7,10})$/.test(waValue)) {
					formMessages.textContent =
						"Nomor WA tidak valid. Awali dengan 08 atau 628.";
					formMessages.className = "alert alert-danger";
					return;
				}

				submitButton.textContent = "Mengirim...";
				submitButton.disabled = true;

				try {
					const response = await fetch("/api/kirim-whatsap", {
						method: "POST",
						headers: {
							"Content-Type": "application/json",
						},
						body: JSON.stringify({
							name: nameValue,
							wa: waValue,
						}),
					});

					const result = await response.json();

					if (response.ok) {
						formMessages.textContent = result.message;
						formMessages.className = "alert alert-success";
						form.reset();
					} else {
						throw new Error(result.message);
					}
				} catch (error) {
					formMessages.textContent =
						error instanceof Error
							? "Error: " + error.message
							: "Error tidak diketahui.";
					formMessages.className = "alert alert-danger";
				} finally {
					submitButton.textContent = "Kirim";
					submitButton.disabled = false;
				}
			});
		} else {
			console.error("Form atau input tidak ditemukan.");
		}
	</script>
</Layout>
